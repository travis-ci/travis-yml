language: ruby
rvm:
- 2.4
sudo: false
env:
  global:
  - secure: RUxZtb1uX7CwXbJOL4Vd42JExlqd/zlNWcO0O6iZERD9Le/63I41mKVNOlJGDPJAagT1lSKY9xKBYtzhKNoppF4xRtyZp/iHqt41HSZ1oe2ix5pUrqG06k2Et8xu0gV1X+75kT4hLTFK0fAPPY6A3qxIss0SG4uPWJO0TWmFOE/cGwTb7zUSGoSyyfpHuIditbt6GScHn69KzXVAlBCv8v7LP+7snkgoffLh6a5pP/6R3vEWjOST6QFX7nqiXiia4btHOqsqzIj5W8zUR4VvrceS2fKgdzjKC5nj+JRfRf5sqVwLglyT9BojaZZ2+eumnyLkhv0Lz8qXh6u6Wr9qjo1WBmtvas46pP80rdFuh67A8c1d8PxvS2AKGtMEViOJLAEb9PVIJoLhv2/7HzCgts9+jSo4BfOoYy6joZ5vnID1Qc6RYXGOXQWt1+NB7gWzmMoSv0xjmu67uuK6A4qnaeAK/UTpMDm8gdXuedg6ozg1Rxlg5WgC87M0VzbbJYyOf984w3ydsT3L8QNncYIJhBEHw5xBFcPFqQKNcn6mglWWm69L3P/3+XhOuKISeBwBIjTc4+AQOPTWT7Pbw1KdyqrEWPWFzKs1YCEvoHfKrAy+zkgIrbklgOPRSVB4rCQdtuW7nj0t4J6T5eO1MhKIHBa35ui/yNz92MJn2zHuuIM=
  - secure: UECPQvK5iZBGO7XGpZ1Lve0TfVXMrAilL5bsypoiWfjzEQM3pLB6mkewpLOXVNPNnQRhITbXx3WhgsE5Nbw1N92a1yKzLE5a5DZ+JdN8qrADt/zFpEWNlcUcpZhSZhHE3uajL9T7elv28+R4gcpqg5QT/u124rn7wvr+87rZjSaop9G3Y/lwjvgpmg/KISgQlmKeOHpnv0KaUm8oKY75K3ag3xOcHg4Nv9WaY8KozYQ1VsnFnsusuBLEf0NMRVBGq9dz1DrqExaa6jNcFfYmLhHWtBDowZH2JSg6QfSZmqkplUDMB8XGJYUlPQJl/KxL3HHSzi1lFtb4Q5VL4VOhFgOIXtDpFOOVkSaTKN4ph8jFlNzJZbAhL2uZb6UmhaaZUCxQIb4V4BrxZJ6UN5Eyto0XAiAjX26JVrMF96d4J31uSZKzU/iv1bLVql2hdA1dtIVZyR3Fkn9yd9DFsOGf7AqngBg4lTojCgq+MzZYSPbXNbQxCw7JIoU46DsH+5cLUQP3Y6GaAaN7qQNuBUTj20lYo1l6KPytAnf77Ft3tqII2g4q6xU2ZoX4W6dpDNB2lt3UQCAPvvkmqeJNLKW+ZS8z7QanHyRFOUPKL4OK+EB852K57O+71ovX/Xy5754neNv1GDre8poK8klyaLHBe2mrQM2x1ixYZIr5kKpmtoI=
  - secure: C9nb29RM3T/0UnwUbEtdXUCYGcOTGHN36/vA5pHppb2ZwdWZP3ZCshhSsLRwhv2OgcxWuLVkuKwUdU1PcVFgsX4IA1SMnOK9JCv2CBSzJV931a04JYt0mAGeYB9m198rOwOjzqpyPZNH3etrLWahNoI7SP6dAloQMGB180icDLgDITiXQ2Yabee6Tf1YjtM98uQIu/DGReRyddTMrqT44Ftb8q8b9Q9A0chCSXlEenE8DKQuoT/8QZ06boaOTbWtbscXJcUpJ1SXww8STn10nb9OOWjqXbasbBLPhAqaO7FSNPwkC/quvHL5cOFv1qS88T7d8FD69e9DIpgi2PzqkJshT58H6DMWgHG4XKXsk2qZjoeTcfPvAVmD0AkBPZsSSAod+sV1dOBr733E8CuL52sUB0lfxyh1NB1PPxfKpYPHuOjqnZRJLgogWSloglM/jBW30jWziyrg6pRSZovoe8CjgB/Gsa0Nsz+J2llYVjEhg4n+qhfSSda7HoCgTjT40zuFVG9scBEpWi5n00fy9T+zdAkFLgUlI+u8NB6GtRFg79dYb9isXPdS2fO/9oOA25wE1Yww9eevPYqh6gIETs0nI5+PkP43YVQsLukUP/8KR6TI+Dbnp/Dqffz3ihcqCifWeKVt9CFassMw4ft03qLeFGvOYuGTYPTNgzirmL4=
  - secure: T4r2O31kfJH33iVyY6VLX88JKrBega2Qz7APEnoSuztdxvmJQZfzOKtLwvbRyEJWad6E/fWHnHP984BgjTndwGyItDrcbqVre9AQvMhLGRC6SMqGq/X1DBV0W7Bk2MQko0hxgs3hEkGbRlEDDddNQKTmLN0H5SiQgZnSXroARko78o02zCQ0hWDXFTukQPsaSSA/FAO1mh97JZC/QcQPy/0eMV2SvztKKcZJWbVcH86AmrEn4uV9pWCazlt47bEfeGyL2O26Pd9w243rsFayNav6sLXzJDd1YJCe3CtLugMEJMnpk0QJxz16gff6bNfoE5Quo+1ou7roOqhZOfuynwD6J0b1ehmz49o79MymoeNbqFndi9+4isSeJ/SdJsRLQMUkczsW+4ngDwj4Jr5iEbbLYchYWjeFWQ1aYWVj1KD0aGONKVm61CegbAzV3r5Pua4CW0mhWkzdQwEYecqaePE/wCd9DY7EBdS9GDpWMmXwB0HDrteB630AjwCJMxEiotq3j90CndnjF+Z1/LEvPmTouGca7Z0qdzlze6SNbtKFVR0nKikvQFb4nWn2B1nsy4DjDZx1Kw8G7v6Al9diQ8glEUgT0QKNe6miwmyL3IbUNO4F57yKg/ukyfPHNslo7chc9iQ40xsUjW5biopf2n4w4xf3rXZRceslk0Z71zE=
  - secure: k+0K2NR0Zz5GfKvpP1Wf1K7Z5vAsOhOvS4z7meBW0NNdohPI2htBHOUforWAjr7z3RWmIKRgxKm8ZjtThd1PECmjV6yZjBvmf8IgmLRLrGv0BVmT9vxGI4JQLeNiwDcmHlKjmniK8c3HTyy/DK1oN3pu3HDslntINHR0bq775R3IOi0769Q/eNfcvcAF+n5pMrEHzFgWbXPwolb3bnXPTYSFzSIkuq1Do7vKjXEu8AuwFSe+CWxHXp2juot7llnJop7zN4CWf8LaJBzUoP0SnzvdWouiBoo2/q5gNTmkILF09n7DA9UJnK3P5fSTSv/GvXJfT8L333b7Vx1YRTxI2OeVkvTPTpTpM9+jq74AnBsr+gff1Tet9cC8qS1v9jY26m0HSDqv0a01uBCKP358aZMSvELj0BPksIMvWEKdpmuxV3Hc8tUxEn5J73EZQCW477a8SJ0vxC7TfWPZEKley8XOx6wvo9BnEhalFZ4/nL2D/zLbfrMCPT8ESYD7e519ld32UYSbJBUlsxeKBpG8KTLedtzAE5BKIHEtfZUURRf9hLsyZPoT6H45vQgMVOmzfkBsOcDn+yRaBXyg4oNR9F5Erncn4Bx6JAX7IV3EVlg0kWYWazPyrGAEG2PbnRS0b9WmuQjuHzdJQTPSYopZfJojFQKXSM8ONQoie42uPsY=
addons:
  apt:
    packages:
    - sshpass
before_script:
- bundle install
script:
  - if [ $TRAVIS_BRANCH = 'staging' ]; then bundle exec jekyll build --config _config.yml,_staging-config.yml; fi
  - if [ $TRAVIS_BRANCH = 'master' ]; then bundle exec jekyll build --config _config.yml,_prod-config.yml; fi

after_success:
- mv _site design-system
- tar -czf package.tgz design-system
- test $TRAVIS_PULL_REQUEST == "false" && test $TRAVIS_BRANCH == "staging" && export SSHPASS=$DEPLOY_PASS
- test $TRAVIS_PULL_REQUEST == "false" && test $TRAVIS_BRANCH == "staging" && sshpass -e scp -o StrictHostKeyChecking=no package.tgz $DEPLOY_USER@$DEPLOY_STAGING_HOST:$DEPLOY_PATH
- test $TRAVIS_PULL_REQUEST == "false" && test $TRAVIS_BRANCH == "staging" && sshpass -e ssh $DEPLOY_USER@$DEPLOY_STAGING_HOST $DEPLOY_PATH/deploy-design-system.sh
- test $TRAVIS_PULL_REQUEST == "false" && test $TRAVIS_BRANCH == "master" && export SSHPASS=$DEPLOY_PASS
- test $TRAVIS_PULL_REQUEST == "false" && test $TRAVIS_BRANCH == "master" && sshpass -e scp -o StrictHostKeyChecking=no package.tgz $DEPLOY_USER@$DEPLOY_PROD_HOST:$DEPLOY_PATH
- test $TRAVIS_PULL_REQUEST == "false" && test $TRAVIS_BRANCH == "master" && sshpass -e ssh $DEPLOY_USER@$DEPLOY_PROD_HOST $DEPLOY_PATH/deploy-design-system.sh
notifications:
  slack:
    secure: pnmMkbxQt0rbioJRwL64lGEoryRqWDH0If4oCssVAP6+k+5h3CDMCeINpfkFhG3Oqro0pKVQnFjiXhDGTInFGX2cTjNm6khyOb0E4q1uRbEBJ2P4xWrfnLcjwq8JTszB1P78yXB/NkuWK2ZmTXWjFYw0FtLOgklvNzjARzxGQEzBn6LrcTmWGy/fxq2E0GdGNQ6xPFJt0Eof9+6Z7aoFUGpobZWHneqrR0yGSPO/CLLxB88jWOuMQLwrgGg3Ua/u/HLgNpdq6h5RhVh25PGZa+MB9pdXRRqbR5FuTIA5uxmG0lAemlcynonPDOvh1bUGKh0z0bhUJC54Nufe+pib2s2ySll+R/rHYdqp6qJ9p6VuMjwezdMq8OAmFKPzsA5isVj1MTW4qxja5zfsIWeRE558kHSvlTxu0MwUqdfM8CuBppUfJZ7QQ1lGpaeLsfJfHxbJbvUi6XeNnf+ffoYsCTKKfxA0JzcReLC5cq25nqMxC/dEEH4RY3VC519tdjjZDc+fYA8e2pO6QUbdXsUnnwOXBleKt1n556c7MWguAcaCwnifJrSFHC8GVPX4L61Ta75ul8TcuNQIMkY5DAgsUYg5+OnWfM2bu1p8kiGc8TthVtezJe5AfXxoLQBZQQdtX/uovCVZiUjaafpmapNGcMwhHIDmbPWwM7JdQgs8eH4=
