language: java
jdk:
- openjdk8
cache:
  directories:
  - "$HOME/.m2"
env:
  global:
  - secure: JUtc/HnhIfTASLdPMDxov7WocqIhDsMEH6Srahk+7d3G1tYu2aS6LI4K3hPjrEJVGEMIqUJvHORmkDmlY1uok8+w5GAzpcltfmasrhJ7rdEt2n694xFb+WEPRgHmsgIPv0QQSFavdy1y6nrS1x3lhCty/QSI0QVDPI4EonjeoMM1Ls7CP6wz2EfOld3APyUsv7u7DvhlpUdmhbn/+SWxOOV/5iJx745Ef4hlQXsvY7vISZ+8HP6FA77OUwA6axgHvrdMgtvfX1YgNvFXixxVBL0XX+myD0rjNAm2mGIJwQLQ7c/YMzPS0Joa/6MxX2zRdD/JFXvBtn6Sek/6/hZozzXVM90mYUmD25IdTLoBE4yrLumPqm5+xEX6C7d0aT2/Wgd+xNmWA9qnNnZKeIuwKGSzbj/0Ek6D43iAOfs+mb32iYc3NKWoTaJfFnqng6yueZTRkZK/+/4MEDzfQZyBf5rPUv910MmO5T0KCxwni3kBr9G9ImPrdfy55tLPZFY5bOoQNzZuBNMQWakb0a91iyZ5Ja09085ZYqfm9zie/EYIe0NUgccUmqqUKzmrBnS68NJ2+74kXPPIdEg26OQwh7ch83sycHvwx1mXycamy6AKDWitmSupTwELHTNBYN2rN/GTmFy41dsY0V8o9xh3zRoeSkXA/t+2pttNYT4vZI4=
  - secure: LOMHbsrLGKMz8zLq+WyCDX9XmA0y2XxvjCaP8uJ5SXLpqnUUfVpEOWbifdaLlBl6+84eIQSpodt1uYooPr3dIjg52n6cobFGc8HmnuDftkY6WQnV8GT53GZp+09FAdY24Fj+x9cEdEuMR26NbodLUqicAmGtFe/ieGEBE4XoV65C7oArJCc4pbP19AXbKT9VP9Cpeo69fNIz0W5QlKeLE1UwWs0AzsFYTG/DEXDZD3ntKqeYaDfqMqrEIWhmLA02AkVdu7LrDSk7wO5pm7DYd9BIA3Y7xkD44mlRouSyyHjY3JRbL++lKhEd5rNufZWsGTD1wgkLiDm5WFsELGh2gDqz7bUk444DftBPf3KXDZ6yeGH9qpWzZJBR3GD+gw1aQFBVrl5AkLZ3rdlEYXB/e+LZerlq7YO/KQ7TTZSJN6sX5q5AOtgCAanDRA5rqB/w+lJ8wQtLJmoeWbhPJKoKBL6IQrH7lAWamgwLQnM8jq7KJ157H2S7JHtBhsfqy7NpiB8qR5DqVFhQmGut0HWuJaB4N6rQlCVfVNk3afdZgWGk0WQPzh1vP+2CDWwCFTdVWiUDvGLMI1gSajh/SUVhs8TgD22qUB2B5loshoSYRzGFZDkY2xJfHm6Uj7L7FHgBq/y5NN0pZrR8uVtIMVjOlirYi3y4a2W1quQf9iE02NI=
  - secure: RG1y8yvb703YJ7/J+KNVFF5jG2sGOImSrVG60HIc8EE1NLamR4EfNdkgSpjhzgPW9tJ6/4dJhw3XP9yNpsdhqBLYKzTcq0HvkjJTj7tLqw3OpIKlrBqT4A7jBT5jF6eG8g0HafQnF02ChHtcw/zKqiYlTl1A6KsyLHjWcXaYLECO4uHcGKEhQvPtjCaOhLLtq+leL8lwiBhA6gQ9C8mar4P1islfbZGI2ICBCtJ9qAxjMYHVeQKOOMe04t/iaAe8HCG6zBP2zSHF5+u9aMQCmmNNEEJ8/ErTIHwscOcH/AKlZKGUGuDrXSVz5wPYQ7S7ZyQ03CCevzXBRYOn851SwDRIwxBQ/kSopaGGZ4Vthm1KMtZWRtXVQ9nRaehK7oUSJ8YqVXUOCQEgiOTeHYxuaclujLrrQsumBETafm663OKPuyULaSm73zZB0ylmZuEdK3OR9jQ9xTGT8fZxFSeCVgMwbUWmLMmXD1cQhRbfkaOirigMyN+BX+pnqJDQ0fLJeJ5AkB9ycZ/r2T/3P+VnTzkDzAkmPAWqIjodAH8xtG/WsU0Z6drpd8JE22YNlweiXckwm+l7iYYetsqmCl3hfbzRdOghsE69acigzfctfaqRloBDBQWuZbV+7Qi6pGFHQjRUEFWPvw2cLoX30UMLZ8AAJgKleHrnezP6+KlhMhw=
  - secure: O2NSOjhycdVM2UDSQYrUPnCOzvLR30zllZoig4ob0sLREnhbKaRZ5sBbGsi5UvOPJmutXqU9zVtDLpU+pjuVQ6TY76KXFt+zJ/uOIk8dwysU/Q6uOwzPVe65N1Syqne/CQ0Mc8ARLKmdzfMnHhOG0w+UGl//3Fry6LZjOBQctSbt75IOtuQQ0l4y0SeZ5lz1gSKjyiotVT7JfHzhN/67H0PBm/LoOTCt9t5YCBMTQ6ZMij4uPjmtn41SdypMMkO+5oG8mmpDuG0fL/inDYNJrvFE2CiPpAgY8oCmM88nkJy74JcNjPZcCJTWwBTGzSPGZFA43weNMXZ8dK9ctwSS/SHFFmCtfLa2LQD12H2wEGJrFFfGl1LElSq8cktxdj1hUbh+LIrYngaod3/265Z3/Pg1TV/cUudrrHTW0NX6IHhUEKVDDi55bBdxzKgXMpboEu05XD8V8/4l3YcWG0gUQpbiwYr9e5wMiBapEe/ZTunojLx+MwzW8BIbMkCcU0OL2LFSGpsxxRrAamyIardOAIi/QNTyxz9pXsyOwJBtufrEeLYY/obLqn3m7G8NcXx1LOeOeFZB/h3hwzMnHFBFO0rruewi/BQHnPyYtmpjidwi8EGn16ETKC8X6pTcBll2UaN4APkJhFlyurr9QzYQMItDL767j4o2kaEzx9zlfvI=
  - secure: JenKUzjlX2EPwyVeClGNsfcYi4kUHiAmjxW1gZUHrZC8BdqyVVi4spQpS5gyCV+QRc9jCK+za8h4U8iHhuUxJaTCEMU3mae1xOe7oDZGtcvH1Qn8fu9HQyQpytoM4G90hamd8D1A5cuEDT9IIUDB8mJa/9a/8eNGFSYFFcjNXxfLUm2gh8GQWMAHvJCUp2CdDoCQMQdzhInIqMiD4w1xlMn+YLLdQ7YlaD4iE+dLZDZRZTYESkeEGKfSDFSFTOG5B2ztpNtuKPJfnBr0WLahVl/EdQt2PxsXvyDITTzn3zs8OyDK9GOaajaN1em9CfnoPr8QH3/k0UYpK4QLY9TMOOpUctNBH5WHN8gC69+3biAz0OccRZe3UFmPWwceHtrzXZOG+w+q7oj0v/afgr+SAfDmJ+IbZPf9MaD5p3edYiInqMZWSG4ypFikQJX1xuaR5TZEfHSz+RnOtO4nGjMCyVzDpwE+hIy1QvQBKFBaRr/AfxB02RzxVPtl0XMVPG8REamv3LS1VY5ZMFDgq3aB554f1XXc9GdryHILDIrL4AcUNwVhaI5OxxPyYnu2ngdoveHs2nibAj9fzUGfKZDYir0znVt9OpBeha366+88Fg4XDxULtaGRI1Ew60WnbmjKGfjtssBIkFQ73wEzPvk9RdLUSUj/RAsEgGdqt93eL08=
services:
- redis-server
before_install:
- curl -O https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.3.2.deb
  && sudo dpkg -i --force-confnew elasticsearch-6.3.2.deb && sudo service elasticsearch
  restart
- mvn install:install-file -Dfile=${TRAVIS_BUILD_DIR}/orchestrator/module/interpreter-api/lib/jtcl-2.7.0.jar
  -DgroupId=tcl.lang -DartifactId=jtcl -Dversion=2.7.0 -Dpackaging=jar
- mkdir -p ~/logs/search/
- find ${TRAVIS_BUILD_DIR}/ -type f -name "log4j2.xml" -print0 | xargs -0 sed -i -e
  's/\/data\/logs/~\/logs/g'
- find ${TRAVIS_BUILD_DIR}/ -type f -name "logback.xml" -print0 | xargs -0 sed -i
  -e 's/\/data\/logs/logs/g'
- find ${TRAVIS_BUILD_DIR}/ -type f -name "application.conf" -print0 | xargs -0 sed
  -i -e 's/\/data\//~\//g'
- find ${TRAVIS_BUILD_DIR}/ -type f -name "*.java" -print0 | xargs -0 sed -i -e 's/\/data\//~\//g'
- sudo apt-get install jq
- wget -O ~/codacy-coverage-reporter-assembly-latest.jar $(curl https://api.github.com/repos/codacy/codacy-coverage-reporter/releases/latest | jq -r '.assets[0].browser_download_url')
- sleep 10
script:
- mvn clean install
after_success:
- find . -name jacoco.xml | awk '{print "java -jar ~/codacy-coverage-reporter-assembly-latest.jar report -l Java -r " $0 " --partial"}' | bash
- java -jar ~/codacy-coverage-reporter-assembly-latest.jar final
